# Pokemonå›¾åƒåˆ†ç±»æ·±åº¦å­¦ä¹ é¡¹ç›®

![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-1.8+-red.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Status](https://img.shields.io/badge/Status-Active-brightgreen.svg)

## é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„Pokemonå›¾åƒåˆ†ç±»ç³»ç»Ÿï¼Œä½¿ç”¨PyTorchæ¡†æ¶å®ç°ã€‚é¡¹ç›®åŒ…å«äº†ä»å¤´è®­ç»ƒå’Œè¿ç§»å­¦ä¹ ä¸¤ç§æ–¹æ³•ï¼Œä¸»è¦ä½¿ç”¨ResNet18ç½‘ç»œç»“æ„å¯¹Pokemonå›¾åƒè¿›è¡Œ5åˆ†ç±»è¯†åˆ«ã€‚

æ”¯æŒçš„Pokemonç±»åˆ«ï¼š
- Bulbasaur (å¦™è›™ç§å­) ğŸŒ±
- Charmander (å°ç«é¾™) ğŸ”¥  
- Mewtwo (è¶…æ¢¦) ğŸ§ 
- Pikachu (çš®å¡ä¸˜) âš¡
- Squirtle (æ°å°¼é¾Ÿ) ğŸ’§

## æ•°æ®é›†å±•ç¤º

æœ¬é¡¹ç›®ä½¿ç”¨çš„Pokemonæ•°æ®é›†åŒ…å«5ä¸ªä¸åŒçš„Pokemonç±»åˆ«ï¼Œæ¯ä¸ªç±»åˆ«åŒ…å«å¤šå¼ ä¸åŒè§’åº¦å’Œé£æ ¼çš„å›¾åƒï¼š

### æ•°æ®é›†æ ·æœ¬å±•ç¤º
ä»¥ä¸‹æ˜¯å„ä¸ªç±»åˆ«çš„ä»£è¡¨æ€§å›¾åƒï¼š

| Pokemonç±»åˆ« | æ ·æœ¬å›¾åƒ | æè¿° |
|-------------|----------|------|
| Bulbasaur (å¦™è›™ç§å­) | ![Bulbasaur](data/pokemon/bulbasaur/00000000.png) | è‰ç³»å®å¯æ¢¦ï¼ŒèƒŒä¸Šæœ‰çƒæ ¹ |
| Charmander (å°ç«é¾™) | ![Charmander](data/pokemon/charmander/00000000.png) | ç«ç³»å®å¯æ¢¦ï¼Œå°¾å·´æœ‰ç«ç„° |
| Mewtwo (è¶…æ¢¦) | ![Mewtwo](data/pokemon/mewtwo/00000000.jpg) | è¶…èƒ½åŠ›ç³»ä¼ è¯´å®å¯æ¢¦ |
| Pikachu (çš®å¡ä¸˜) | ![Pikachu](data/pokemon/pikachu/00000000.png) | ç”µç³»å®å¯æ¢¦ï¼Œæ‹›ç‰Œè§’è‰² |
| Squirtle (æ°å°¼é¾Ÿ) | ![Squirtle](data/pokemon/squirtle/00000000.png) | æ°´ç³»å®å¯æ¢¦ï¼Œæœ‰é¾Ÿå£³ |

### æ•°æ®é›†ç»Ÿè®¡
- **æ€»å›¾åƒæ•°é‡**: çº¦1167å¼ å›¾åƒ
- **å›¾åƒæ ¼å¼**: PNG, JPG, JPEG
- **æ•°æ®åˆ’åˆ†**: è®­ç»ƒé›†60% / éªŒè¯é›†20% / æµ‹è¯•é›†20%
- **å›¾åƒå°ºå¯¸**: ç»Ÿä¸€resizeåˆ°224Ã—224åƒç´ 

## é¡¹ç›®ç»“æ„

```
3_1_project/
â”œâ”€â”€ best_resnet18.pth          # è®­ç»ƒå¥½çš„æœ€ä½³æ¨¡å‹æƒé‡
â”œâ”€â”€ readme.md                  # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ data/                      # æ•°æ®é›†ç›®å½•
â”‚   â”œâ”€â”€ FashionMNIST/         # FashionMNISTæ•°æ®é›†
â”‚   â””â”€â”€ pokemon/              # Pokemonå›¾åƒæ•°æ®é›†
â”‚       â”œâ”€â”€ images.csv        # å›¾åƒç´¢å¼•æ–‡ä»¶
â”‚       â”œâ”€â”€ bulbasaur/        # å¦™è›™ç§å­å›¾åƒ
â”‚       â”œâ”€â”€ charmander/       # å°ç«é¾™å›¾åƒ
â”‚       â”œâ”€â”€ mewtwo/           # è¶…æ¢¦å›¾åƒ
â”‚       â”œâ”€â”€ pikachu/          # çš®å¡ä¸˜å›¾åƒ
â”‚       â””â”€â”€ squirtle/         # æ°å°¼é¾Ÿå›¾åƒ
â”œâ”€â”€ image_classification/      # ä¸»è¦ä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data.py               # æ•°æ®åŠ è½½å’Œé¢„å¤„ç†
â”‚   â”œâ”€â”€ test.ipynb            # æµ‹è¯•å’Œè®­ç»ƒçš„Jupyter notebook
â”‚   â”œâ”€â”€ train_from_scratch.py # ä»é›¶å¼€å§‹è®­ç»ƒ
â”‚   â”œâ”€â”€ train_with_pretrained.py # ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹çš„è¿ç§»å­¦ä¹ 
â”‚   â”œâ”€â”€ train--.py            # ç®€åŒ–çš„è®­ç»ƒè„šæœ¬
â”‚   â””â”€â”€ net/                  # ç½‘ç»œç»“æ„å®šä¹‰
â”‚       â”œâ”€â”€ AlexNet.py        # AlexNetç½‘ç»œç»“æ„
â”‚       â”œâ”€â”€ ResNet.py         # ResNetç½‘ç»œç»“æ„å’Œæ®‹å·®å—
â”‚       â””â”€â”€ ThreeLayerNetwork.py # ä¸‰å±‚å…¨è¿æ¥ç½‘ç»œ
â””â”€â”€ learn/                    # å­¦ä¹ å’Œå®éªŒä»£ç 
    â”œâ”€â”€ 3.6.ipynb
    â”œâ”€â”€ 3.7.ipynb
    â””â”€â”€ try.ipynb
```

## æ¨¡å‹æ¶æ„

### ResNet18 ç½‘ç»œç»“æ„
```
è¾“å…¥å›¾åƒ (3Ã—224Ã—224)
    â†“
åˆå§‹å·ç§¯å±‚ (3Ã—3 Conv, stride=2)
    â†“ 
ResNet Block 1 (16 channels)
    â†“
ResNet Block 2 (32 channels) 
    â†“
ResNet Block 3 (64 channels)
    â†“
ResNet Block 4 (128 channels)
    â†“
å…¨å±€å¹³å‡æ± åŒ–
    â†“
å…¨è¿æ¥å±‚ (5 classes)
    â†“
è¾“å‡ºé¢„æµ‹ (5ç»´æ¦‚ç‡åˆ†å¸ƒ)
```

### ä¸‰å±‚å…¨è¿æ¥ç½‘ç»œç»“æ„
```
è¾“å…¥å›¾åƒ (3Ã—224Ã—224) 
    â†“
å±•å¹³ (150,528ç»´å‘é‡)
    â†“
å…¨è¿æ¥å±‚1 (150,528 â†’ 128) + ReLU
    â†“  
å…¨è¿æ¥å±‚2 (128 â†’ 64) + ReLU
    â†“
å…¨è¿æ¥å±‚3 (64 â†’ 5)
    â†“
è¾“å‡ºé¢„æµ‹ (5ç»´æ¦‚ç‡åˆ†å¸ƒ)
```

### è®­ç»ƒæµç¨‹å›¾
```
æ•°æ®é›† (Pokemon Images)
    â†“
æ•°æ®é¢„å¤„ç† (Resize, Normalize)
    â†“
æ•°æ®åŠ è½½å™¨ (DataLoader)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä»å¤´è®­ç»ƒ       â”‚    â”‚   è¿ç§»å­¦ä¹        â”‚
â”‚  ResNet18      â”‚    â”‚   é¢„è®­ç»ƒResNet18  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“                      â†“
Adamä¼˜åŒ–å™¨ + äº¤å‰ç†µæŸå¤±å‡½æ•°
    â†“
éªŒè¯é›†è¯„ä¼° â†’ ä¿å­˜æœ€ä½³æ¨¡å‹
    â†“
æµ‹è¯•é›†æœ€ç»ˆè¯„ä¼°
```

## ä¸»è¦åŠŸèƒ½

### 1. æ•°æ®å¤„ç† (`data.py`)
- **Pokemonæ•°æ®é›†ç±»**ï¼šè‡ªå®šä¹‰æ•°æ®é›†ç±»ï¼Œæ”¯æŒè®­ç»ƒ/éªŒè¯/æµ‹è¯•æ•°æ®åˆ’åˆ†
- **æ•°æ®é¢„å¤„ç†**ï¼šå›¾åƒresizeã€æ•°æ®å¢å¼ºã€æ ‡å‡†åŒ–
- **æ•°æ®åŠ è½½**ï¼šæ”¯æŒå¤šç§å›¾åƒæ ¼å¼(PNG, JPG, JPEG)
- **æ•°æ®åˆ’åˆ†**ï¼šè®­ç»ƒé›†60%ï¼ŒéªŒè¯é›†20%ï¼Œæµ‹è¯•é›†20%

### 2. ç½‘ç»œç»“æ„ (`net/`)
- **ResNet18**ï¼šå®ç°äº†æ ‡å‡†çš„ResNet18ç½‘ç»œç»“æ„
- **ThreeLayerNetwork**ï¼šç®€å•çš„ä¸‰å±‚å…¨è¿æ¥ç½‘ç»œï¼ˆç‹¬ç«‹æ–‡ä»¶ï¼‰
- **ResBlk**ï¼šResNetçš„åŸºæœ¬æ®‹å·®å—å®ç°
- **AlexNet**ï¼šç»å…¸çš„AlexNetç½‘ç»œç»“æ„

### 3. è®­ç»ƒæ–¹æ³•

#### ä»å¤´è®­ç»ƒ (`train_from_scratch.py`)
- ä½¿ç”¨è‡ªå®šä¹‰ResNet18ç½‘ç»œä»é›¶å¼€å§‹è®­ç»ƒ
- æ”¯æŒä¸‰å±‚å…¨è¿æ¥ç½‘ç»œè®­ç»ƒ
- Adamä¼˜åŒ–å™¨ï¼Œäº¤å‰ç†µæŸå¤±å‡½æ•°

#### è¿ç§»å­¦ä¹  (`train_with_pretrained.py`)
- ä½¿ç”¨PyTorché¢„è®­ç»ƒçš„ResNet18æ¨¡å‹
- å†»ç»“ç‰¹å¾æå–å±‚ï¼Œåªè®­ç»ƒåˆ†ç±»å™¨
- æ›´å¿«çš„æ”¶æ•›é€Ÿåº¦å’Œæ›´å¥½çš„æ€§èƒ½

### 4. æ¨¡å‹è¯„ä¼°
- éªŒè¯é›†å‡†ç¡®ç‡ç›‘æ§
- æœ€ä½³æ¨¡å‹è‡ªåŠ¨ä¿å­˜
- æµ‹è¯•é›†æ€§èƒ½è¯„ä¼°

## ç¯å¢ƒè¦æ±‚

### æ–¹å¼ä¸€ï¼šä½¿ç”¨requirements.txtï¼ˆæ¨èï¼‰
```bash
pip install -r requirements.txt
```

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨å®‰è£…
```python
torch>=1.8.0
torchvision>=0.9.0
d2l>=0.17.0
Pillow>=8.0.0
numpy>=1.19.0
matplotlib>=3.3.0
jupyter>=1.0.0
```

### ç³»ç»Ÿè¦æ±‚
- Python 3.7+
- CUDA 10.2+ (å¯é€‰ï¼Œç”¨äºGPUåŠ é€Ÿ)
- è‡³å°‘4GB RAM

## å¿«é€Ÿå¼€å§‹

### ğŸš€ ä¸€é”®è¿è¡Œ
```bash
# 1. å…‹éš†é¡¹ç›®
git clone <é¡¹ç›®åœ°å€>
cd 3_1_project

# 2. å®‰è£…ä¾èµ–
pip install torch torchvision d2l pillow numpy matplotlib

# 3. è¿è¡Œè®­ç»ƒ (æ¨èä½¿ç”¨Jupyter Notebook)
jupyter notebook image_classification/test.ipynb

# æˆ–è€…ç›´æ¥è¿è¡ŒPythonè„šæœ¬
cd image_classification
python train_with_pretrained.py  # è¿ç§»å­¦ä¹ 
python train_from_scratch.py     # ä»å¤´è®­ç»ƒ
python train--.py                # ç®€åŒ–ç‰ˆæœ¬
```

### ğŸ“Š ç›‘æ§è®­ç»ƒè¿‡ç¨‹
è®­ç»ƒè¿‡ç¨‹ä¸­æ‚¨å°†çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
ä½¿ç”¨è®¾å¤‡ï¼š cuda
epoch 0, step 0, loss 1.6234
epoch 0, step 10, loss 1.4521
epoch 0, val acc 0.3421, best acc 0.3421 at epoch 0
epoch 1, step 0, loss 1.2314
epoch 1, step 10, loss 1.1203
epoch 1, val acc 0.4536, best acc 0.4536 at epoch 1
...
best acc 0.8245 at epoch 15
```

## ä½¿ç”¨æ–¹æ³•

### 1. æ•°æ®å‡†å¤‡
ç¡®ä¿Pokemonå›¾åƒæ•°æ®å·²æ”¾ç½®åœ¨`data/pokemon/`ç›®å½•ä¸‹ï¼Œæ¯ä¸ªç±»åˆ«ä¸€ä¸ªå­æ–‡ä»¶å¤¹ã€‚

### 2. è®­ç»ƒæ¨¡å‹

#### ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ï¼ˆæ¨èï¼‰
```python
# åœ¨test.ipynbä¸­è¿è¡Œæˆ–ç›´æ¥è¿è¡Œä»¥ä¸‹ä»£ç 
import torch
from data import Pokemon
import train_with_pretrained as twp

# è®¾ç½®è®­ç»ƒå‚æ•°
batch_size = 16
lr = 3e-4
epochs = 30
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')

# åŠ è½½æ•°æ®
train_db = Pokemon('data/pokemon', 224, 'train')
val_db = Pokemon('data/pokemon', 224, 'val')
test_db = Pokemon('data/pokemon', 224, 'test')

train_iter = torch.utils.data.DataLoader(train_db, batch_size, shuffle=True, num_workers=4)
val_iter = torch.utils.data.DataLoader(val_db, batch_size, shuffle=False, num_workers=4)
test_iter = torch.utils.data.DataLoader(test_db, batch_size, shuffle=False, num_workers=4)

# å¼€å§‹è®­ç»ƒ
twp.train_with_resnet18(train_iter, val_iter, epochs, lr, device)

# æµ‹è¯•æ¨¡å‹
twp.test_with_resnet18(test_iter, device)
```

#### ä»å¤´è®­ç»ƒ
```python
import train_from_scratch as tfs

# ä½¿ç”¨ç›¸åŒçš„æ•°æ®åŠ è½½ä»£ç 
tfs.train_with_resnet18(train_iter, val_iter, epochs, lr, device)
```

### 3. æ¨¡å‹æ¨ç†
è®­ç»ƒå®Œæˆåï¼Œæœ€ä½³æ¨¡å‹æƒé‡ä¼šè‡ªåŠ¨ä¿å­˜ä¸º`best_resnet18.pth`ï¼Œå¯ä»¥ç”¨äºåç»­çš„æ¨ç†ä»»åŠ¡ã€‚

## æŠ€æœ¯ç‰¹ç‚¹

1. **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ•°æ®å¤„ç†ã€ç½‘ç»œç»“æ„ã€è®­ç»ƒæµç¨‹åˆ†ç¦»
2. **çµæ´»çš„æ•°æ®åŠ è½½**ï¼šæ”¯æŒå¤šç§å›¾åƒæ ¼å¼å’Œæ•°æ®å¢å¼º
3. **è¿ç§»å­¦ä¹ **ï¼šåˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹æå‡æ€§èƒ½
4. **è‡ªåŠ¨ä¿å­˜**ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨ä¿å­˜æœ€ä½³æ¨¡å‹
5. **è®¾å¤‡è‡ªé€‚åº”**ï¼šæ”¯æŒCPUå’ŒGPUè®­ç»ƒ

## å®éªŒç»“æœ

é¡¹ç›®æä¾›äº†ä¸¤ç§è®­ç»ƒæ–¹å¼çš„å¯¹æ¯”ï¼š
- **ä»å¤´è®­ç»ƒ**ï¼šå®Œå…¨è®­ç»ƒç½‘ç»œæ‰€æœ‰å‚æ•°
- **è¿ç§»å­¦ä¹ **ï¼šåŸºäºImageNeté¢„è®­ç»ƒæ¨¡å‹å¾®è°ƒ

### æ€§èƒ½å¯¹æ¯”

| è®­ç»ƒæ–¹å¼ | ç½‘ç»œç»“æ„ | è®­ç»ƒæ—¶é—´ | éªŒè¯å‡†ç¡®ç‡ | ä¼˜åŠ¿ |
|---------|----------|----------|------------|------|
| è¿ç§»å­¦ä¹  | é¢„è®­ç»ƒResNet18 | è¾ƒçŸ­ | æ›´é«˜ | å¿«é€Ÿæ”¶æ•›ï¼Œæ€§èƒ½æ›´å¥½ |
| ä»å¤´è®­ç»ƒ | è‡ªå®šä¹‰ResNet18 | è¾ƒé•¿ | è¾ƒä½ | å®Œå…¨æŒæ§è®­ç»ƒè¿‡ç¨‹ |
| ç®€å•ç½‘ç»œ | ä¸‰å±‚å…¨è¿æ¥ | æœ€çŸ­ | æœ€ä½ | å¿«é€Ÿå®éªŒï¼ŒåŸºçº¿å¯¹æ¯” |

### è®­ç»ƒæ›²çº¿ç¤ºä¾‹
```
Lossæ›²çº¿:
è¿ç§»å­¦ä¹ : â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘  (å¿«é€Ÿä¸‹é™)
ä»å¤´è®­ç»ƒ: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–“â–‘â–‘â–‘â–‘  (ç¼“æ…¢ä¸‹é™)
ç®€å•ç½‘ç»œ: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–‘  (æ”¶æ•›å›°éš¾)

Accuracyæ›²çº¿:
è¿ç§»å­¦ä¹ : â–‘â–‘â–‘â–“â–“â–“â–“â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (å¿«é€Ÿæå‡)
ä»å¤´è®­ç»ƒ: â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–“  (ç¨³æ­¥æå‡)  
ç®€å•ç½‘ç»œ: â–‘â–‘â–‘â–‘â–‘â–‘â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“  (ç¼“æ…¢æå‡)
```

è¿ç§»å­¦ä¹ é€šå¸¸èƒ½å¤Ÿï¼š
- âœ… æ›´å¿«æ”¶æ•›
- âœ… æ›´å¥½çš„åˆ†ç±»ç²¾åº¦  
- âœ… æ›´å°‘çš„è®­ç»ƒæ•°æ®éœ€æ±‚
- âœ… æ›´ç¨³å®šçš„è®­ç»ƒè¿‡ç¨‹

## æ‰©å±•å»ºè®®

1. **æ•°æ®å¢å¼º**ï¼šæ·»åŠ æ›´å¤šæ•°æ®å¢å¼ºæŠ€æœ¯æå‡æ¨¡å‹æ³›åŒ–èƒ½åŠ›
2. **ç½‘ç»œç»“æ„**ï¼šå°è¯•å…¶ä»–ç½‘ç»œç»“æ„å¦‚ResNet50ã€EfficientNetç­‰
3. **æŸå¤±å‡½æ•°**ï¼šå®éªŒä¸åŒçš„æŸå¤±å‡½æ•°å¦‚Focal Loss
4. **ä¼˜åŒ–å™¨**ï¼šå°è¯•ä¸åŒçš„ä¼˜åŒ–ç­–ç•¥
5. **é›†æˆå­¦ä¹ **ï¼šç»“åˆå¤šä¸ªæ¨¡å‹æå‡é¢„æµ‹æ€§èƒ½

## ä½œè€…

Thomas

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ã€‚